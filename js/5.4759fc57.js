(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"3be4":function(e,a,t){"use strict";t.r(a);var o=function(){var e=this,a=e._self._c;e._self._setupProxy;return a("div",[a("div",{staticClass:"q-pa-md q-gutter-sm"},[a("q-breadcrumbs",[a("q-breadcrumbs-el",{attrs:{label:"Home"}}),a("q-breadcrumbs-el",{attrs:{label:"Cenário"}}),a("q-breadcrumbs-el",{attrs:{label:"Novo"}})],1)],1),a("div",{staticClass:"q-pa-md q-gutter-sm"},[a("q-card",{staticClass:"my-card"},[a("q-card-section",[a("div",{staticClass:"text-h6"},[e._v("Cenário")]),a("div",{staticClass:"text-subtitle2"},[e._v(e._s(e.cenarioInput.descricao))])]),a("q-card-section",[a("q-form",{ref:"formAtualizar"},[a("div",{staticClass:"q-pa-md q-gutter-md"},[a("q-input",{attrs:{outlined:"",label:"Descrição do cenario",focus:"",rules:[e=>e&&e.length>0||"Campo de preenchimento obrigatório"]},model:{value:e.cenarioInput.descricao,callback:function(a){e.$set(e.cenarioInput,"descricao",a)},expression:"cenarioInput.descricao"}}),a("q-select",{attrs:{outlined:"",options:e.mapeamentos,label:"Mapeamento",readonly:""},on:{input:e.mapeamentoSelecionado},model:{value:e.mapeamentoId,callback:function(a){e.mapeamentoId=a},expression:"mapeamentoId"}}),a("q-select",{attrs:{outlined:"",options:e.personas,label:"Persona",readonly:""},on:{input:e.pessoaSelecionada},model:{value:e.personaId,callback:function(a){e.personaId=a},expression:"personaId"}}),e.cenarioInput.mapeamentoTemplatePersonaCenarioItens.length>0?a("div",e._l(e.cenarioInput.mapeamentoTemplatePersonaCenarioItens,(function(e){return a("div",{key:e.mapeamentoItem.mapeamentoItemId,staticClass:"text-h6",staticStyle:{"margin-top":"10px"}},[a("cenario-mapeamento-template-persona-component",{attrs:{mapeamentoTemplatePersonaCenario:e}})],1)})),0):e._e()],1)])],1),a("q-separator",{attrs:{dark:""}}),a("q-card-actions",[a("q-btn",{attrs:{color:"primary",icon:"check",label:"Salvar",flat:""},on:{click:function(a){return e.atualizar()}}}),a("q-btn",{attrs:{color:"lingth",icon:"visibility",label:"Compilado",flat:""},on:{click:function(a){return e.visualizarCompilado()}}}),a("q-btn",{attrs:{icon:"arrow_back",label:"Voltar",flat:""},on:{click:function(a){return e.voltar()}}})],1)],1)],1),a("dialog-visualizar-compilado",{ref:"dialogVisualizarCompilado",attrs:{compliado:e.cenarioInput.compilado}})],1)},n=[],i=t("1b40"),r=t("2587"),s=t("0564"),c=t("ec43"),l=t("dc7e"),p=t("934f"),d=t("c647"),m=function(){var e=this,a=e._self._c;e._self._setupProxy;return a("q-dialog",{ref:"dialog",attrs:{"full-width":"","full-height":"",cancel:""},model:{value:e.showModal,callback:function(a){e.showModal=a},expression:"showModal"}},[a("q-card",{staticClass:"column full-height full-width"},[a("q-card-section",{staticClass:"row items-center q-pb-none"},[a("div",{staticClass:"text-h6"},[e._v("Compilado")]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),a("q-card-section",{staticClass:"q-gutter-md"},[a("v-jsoneditor",{attrs:{options:e.options,height:"500px"},model:{value:e.compiladoOutput,callback:function(a){e.compiladoOutput=a},expression:"compiladoOutput"}})],1),a("q-card-actions",{staticClass:"bg-white text-teal",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Voltar",value:""},on:{click:function(a){return e.$emit("close")}}})],1)],1)],1)},u=[],h=t("27f7"),f=function(e,a,t,o){var n,i=arguments.length,r=i<3?a:null===o?o=Object.getOwnPropertyDescriptor(a,t):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,a,t,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(r=(i<3?n(r):i>3?n(a,t,r):n(a,t))||r);return i>3&&r&&Object.defineProperty(a,t,r),r};let I=class extends i["c"]{constructor(){super(...arguments),this.showModal=!1,this.options={type:Object,mode:"code"},this.compiladoOutput={}}show(e){this.compiladoOutput=e,this.showModal=!0}created(){this.compiladoOutput=this.compilado}};f([Object(i["b"])()],I.prototype,"compilado",void 0),I=f([Object(i["a"])({components:{VJsoneditor:h["a"]}})],I);var v=I,b=v,q=t("2877"),C=t("24e8"),P=t("f09f"),g=t("a370"),y=t("2c91"),w=t("9c40"),_=t("4b7e"),x=t("7f67"),S=t("eebe"),O=t.n(S),Q=Object(q["a"])(b,m,u,!1,null,null,null),$=Q.exports;O()(Q,"components",{QDialog:C["a"],QCard:P["a"],QCardSection:g["a"],QSpace:y["a"],QBtn:w["a"],QCardActions:_["a"]}),O()(Q,"directives",{ClosePopup:x["a"]});var k=function(e,a,t,o){var n,i=arguments.length,r=i<3?a:null===o?o=Object.getOwnPropertyDescriptor(a,t):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,a,t,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(r=(i<3?n(r):i>3?n(a,t,r):n(a,t))||r);return i>3&&r&&Object.defineProperty(a,t,r),r},M=function(e,a,t,o){function n(e){return e instanceof t?e:new t((function(a){a(e)}))}return new(t||(t=Promise))((function(t,i){function r(e){try{c(o.next(e))}catch(a){i(a)}}function s(e){try{c(o["throw"](e))}catch(a){i(a)}}function c(e){e.done?t(e.value):n(e.value).then(r,s)}c((o=o.apply(e,a||[])).next())}))};let j=class extends i["c"]{constructor(){super(...arguments),this.cenarioId="",this.mapeamentoId="",this.personaId="",this.mapeamentos=[],this.mapeamentoInput={templateId:"",tipoMapeamentoItem:0,template:{},mapeamentoItens:[]},this.cenarioInput={descricao:"",mapeamentoId:"",templateId:"",templateDescricao:"",personaId:"",persona:{},compilado:{},mapeamentoTemplatePersonaCenarioItens:[]},this.personaSelecionada={},this.personas=[]}visualizarCompilado(){this.$refs.dialogVisualizarCompilado.show(this.cenarioInput.compilado)}atualizar(){this.$refs.formAtualizar.validate().then((e=>{e?this._cenarioService.atualizar(this.cenarioId,this.cenarioInput).then((e=>{console.log(e),this.cenarioInput.compilado=e.data.compilado,this.$q.notify(e.notificacao)})).catch((e=>{this.$q.notify(e.notificacao)})).finally((()=>{this.$q.loading.hide()})):this.$q.notify(s["a"].erro("Favor preencher todos os campos obrigatórios"))}))}recuperaMapeamentos(){this._mapeamentoService.listar().then((e=>{this.mapeamentos=e.map((e=>{var a;return{label:null!==(a=e.template.descricao)&&void 0!==a?a:"",value:e._id,data:e}}))})).catch((e=>{this.$q.notify(e)})).finally((()=>{this.$q.loading.hide()}))}recuperaCenarioPorId(e){return new Promise((a=>{this._cenarioService.recuperaPorId(e).then((e=>{this.cenarioInput=e,this.mapeamentoId=this.mapeamentos.filter((e=>e.value==this.cenarioInput.mapeamentoId))[0],this.personaId=this.personas.filter((e=>e.value==this.cenarioInput.personaId))[0],this.montaValueDoMapeamentoPorPersona()})).catch((e=>{this.$q.notify(e)})).finally((()=>{this.$q.loading.hide(),a("")}))}))}recuperaPersonas(){return new Promise((e=>{this._personaService.listar().then((e=>{this.personas=e.map((e=>{var a,t;let o={};return e.persona["nome"]&&(o={label:null!==(a=e.persona.nome)&&void 0!==a?a:"",value:e._id,data:e.persona}),{label:null!==(t=e.persona.nome)&&void 0!==t?t:"",value:e._id,data:e.persona}}))})).catch((e=>{this.$q.notify(e)})).finally((()=>{this.$q.loading.hide(),e("")}))}))}pessoaSelecionada(e){this.personaSelecionada=e,this.cenarioInput.persona=e.data,this.cenarioInput.personaId=e.value,this.montaValueDoMapeamentoPorPersona()}mapeamentoSelecionado(e){this.cenarioInput.mapeamentoId=e.data._id,this.cenarioInput.templateId=e.data.templateId,this.cenarioInput.templateDescricao=e.data.template.descricao,this.cenarioInput.mapeamentoTemplatePersonaCenarioItens=e.data.mapeamentoItens.map((e=>{let a={mapeamentoTemplatePersonaCenarioItensId:e.mapeamentoItemId,mapeamentoItem:e,value:null};return a})),this.montaValueDoMapeamentoPorPersona()}montaValueDoMapeamentoPorPersona(){this.cenarioInput.persona&&this.cenarioInput.mapeamentoId&&this.cenarioInput.mapeamentoTemplatePersonaCenarioItens.forEach((e=>{void 0==e.value&&e.mapeamentoItem.pathPersona&&(e.value=p["a"].recuperar(this.cenarioInput.persona,e.mapeamentoItem.pathPersona))}))}created(){return M(this,void 0,void 0,(function*(){this._mapeamentoService=new c["a"],this._personaService=new l["a"],this._cenarioService=new r["a"],this.cenarioId=this.$route.params.cenarioId,yield Promise.all([this.recuperaMapeamentos(),this.recuperaPersonas()]),yield this.recuperaCenarioPorId(this.cenarioId)}))}voltar(){this.$router.replace({name:"cenario"})}};j=k([Object(i["a"])({components:{CenarioMapeamentoTemplatePersonaComponent:d["a"],DialogVisualizarCompilado:$}})],j);var z=j,D=z,V=t("ead5"),T=t("079e"),R=t("0378"),A=t("27f9"),B=t("ddd8"),J=t("eb85"),N=Object(q["a"])(D,o,n,!1,null,null,null);a["default"]=N.exports;O()(N,"components",{QBreadcrumbs:V["a"],QBreadcrumbsEl:T["a"],QCard:P["a"],QCardSection:g["a"],QForm:R["a"],QInput:A["a"],QSelect:B["a"],QSeparator:J["a"],QCardActions:_["a"],QBtn:w["a"]})}}]);